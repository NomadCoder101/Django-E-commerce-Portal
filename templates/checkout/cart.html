{% extends "base.html" %} {% load i18n %} {% load static %} {% block title %}{%
trans "Shopping Cart" %}{% endblock %} {% block content %}
<div class="container mx-auto px-4 py-8">
  <h1 class="text-2xl font-bold text-gray-900 mb-8">
    {% trans "Shopping Cart" %}
  </h1>

  {% if cart.items.exists %}
  <div class="flex flex-col lg:flex-row lg:space-x-8">
    {# Cart Items #}
    <div class="lg:w-2/3">
      {% for item in cart.items.all %}
      <div
        class="flex items-center border-b border-gray-200 py-4"
        id="cart-item-{{ item.id }}"
      >
        {# Product Image #}
        <div class="w-24 flex-shrink-0">
          {% if item.product.images.first %}
          <img
            src="{{ item.product.images.first.image.url }}"
            alt="{{ item.product.name }}"
            class="w-full h-24 object-cover rounded"
          />
          {% endif %}
        </div>

        {# Product Info #}
        <div class="ml-4 flex-1">
          <h3 class="text-lg font-medium text-gray-900">
            <a
              href="{% url 'catalog:product_detail' item.product.slug %}"
              class="hover:text-blue-600"
            >
              {{ item.product.name }}
            </a>
          </h3>
          {% if item.variant %}
          <p class="text-sm text-gray-600">{{ item.variant.name }}</p>
          {% endif %}
          <div class="mt-1 text-sm text-gray-600">
            {{ item.get_price_display }} x {{ item.quantity }}
          </div>
        </div>

        {# Quantity Controls #}
        <div class="ml-4">
          <div class="flex items-center border rounded">
            <button
              class="px-3 py-1 hover:bg-gray-100"
              hx-post="{% url 'checkout:update_cart' item.id %}"
              hx-vals='{"quantity": {{ item.quantity|add:"-1" }}}'
              hx-target="#cart-item-{{ item.id }}"
              {%
              if
              item.quantity
              <="1"
              %}disabled{%
              endif
              %}
            >
              -
            </button>
            <span class="px-3 py-1">{{ item.quantity }}</span>
            <button
              class="px-3 py-1 hover:bg-gray-100"
              hx-post="{% url 'checkout:update_cart' item.id %}"
              hx-vals='{"quantity": {{ item.quantity|add:"1" }}}'
            >
              +
            </button>
          </div>
        </div>

        {# Total and Remove #}
        <div class="ml-4 text-right">
          <div
            class="text-lg font-medium text-gray-900"
            id="item-total-{{ item.id }}"
          >
            {{ item.get_total_display }}
          </div>
          <button
            class="text-sm text-red-600 hover:text-red-800"
            hx-post="{% url 'checkout:remove_from_cart' item.id %}"
            hx-target="#cart-item-{{ item.id }}"
            hx-swap="outerHTML"
          >
            {% trans "Remove" %}
          </button>
        </div>
      </div>
      {% endfor %}
    </div>

    {# Order Summary #}
    <div class="lg:w-1/3 mt-8 lg:mt-0">
      <div class="bg-gray-50 rounded-lg p-6">
        <h2 class="text-lg font-medium text-gray-900 mb-4">
          {% trans "Order Summary" %}
        </h2>

        <div class="border-t border-gray-200 py-4">
          <div class="flex justify-between">
            <span class="text-base font-medium text-gray-900"
              >{% trans "Subtotal" %}</span
            >
            <span class="text-base font-medium text-gray-900"
              >{{ cart.get_subtotal_display }}</span
            >
          </div>
          {% if cart.get_discount %}
          <div class="flex justify-between mt-2">
            <span class="text-base text-gray-600">{% trans "Discount" %}</span>
            <span class="text-base text-red-600"
              >-{{ cart.get_discount_display }}</span
            >
          </div>
          {% endif %}
          <div class="flex justify-between mt-4">
            <span class="text-lg font-semibold text-gray-900"
              >{% trans "Total" %}</span
            >
            <span class="text-lg font-semibold text-gray-900"
              >{{ cart.get_total_display }}</span
            >
          </div>
        </div>

        <a
          href="{% url 'checkout:checkout' %}"
          class="mt-6 w-full bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 text-center block"
        >
          {% trans "Proceed to Checkout" %}
        </a>
      </div>
    </div>
  </div>
  {% else %}
  <div class="text-center py-12">
    <div class="text-gray-600 mb-4">{% trans "Your cart is empty" %}</div>
    <a
      href="{% url 'catalog:products' %}"
      class="inline-block bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700"
    >
      {% trans "Continue Shopping" %}
    </a>
  </div>
  {% endif %}
</div>
{% endblock %}
